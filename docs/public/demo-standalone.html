<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Japan Map Selector - Interactive Demo</title>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    .demo-controls {
      background: #f6f6f7;
      padding: 16px;
      border-bottom: 1px solid #e2e2e3;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
    .demo-controls label {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .demo-controls select {
      padding: 4px 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: white;
    }
    .demo-controls button {
      padding: 4px 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: white;
      cursor: pointer;
    }
    .demo-controls button:hover {
      background: #f0f0f0;
    }
    #map-demo {
      width: 100%;
      height: 600px;
      background: white;
      overflow: hidden;
    }
    #map-demo svg {
      width: 100%;
      height: 100%;
    }
    .demo-info {
      background: #f6f6f7;
      padding: 16px;
      border-top: 1px solid #e2e2e3;
      font-size: 14px;
    }
    .loading {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      color: #666;
    }
    .error {
      color: #d32f2f;
      padding: 20px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="demo-controls">
    <label>テーマ: 
      <select id="theme-select">
        <option value="default">Default</option>
        <option value="dark">Dark</option>
        <option value="warm">Warm</option>
        <option value="cool">Cool</option>
        <option value="monochrome">Monochrome</option>
        <option value="colorful" selected>Colorful</option>
        <option value="random">Random</option>
      </select>
    </label>
    
    <label>簡略化レベル: 
      <select id="simplification-select">
        <option value="original">Original</option>
        <option value="high">High</option>
        <option value="medium" selected>Medium</option>
        <option value="low">Low</option>
        <option value="ultra-low">Ultra Low</option>
      </select>
    </label>
    
    <label>ディフォルメ: 
      <select id="deform-select">
        <option value="none" selected>なし</option>
        <option value="grid">グリッド</option>
        <option value="hexagon">六角形</option>
      </select>
    </label>
    
    <button id="reset-btn">リセット</button>
  </div>
  
  <div id="map-demo">
    <div class="loading">地図を読み込み中...</div>
  </div>
  
  <div class="demo-info" id="demo-info">
    マウスで地図を操作してください。クリックで都道府県を選択、ホイールでズーム、ドラッグで移動できます。
  </div>

  <script>
    // デモ用の簡易実装（実際のjapan-map-selectorライブラリを使用せずに動作するサンプル）
    
    class SimpleMapDemo {
      constructor() {
        this.theme = 'colorful';
        this.simplificationLevel = 'medium';
        this.deformMode = 'none';
        this.selectedPrefecture = null;
        this.hoveredItem = null;
        
        this.init();
      }
      
      async init() {
        try {
          // 仮のデモ表示
          this.render();
          this.setupEventListeners();
          
          document.getElementById('demo-info').textContent = 
            '※これはデモ用の静的な表示です。実際の動作は本番環境でご確認ください。';
        } catch (error) {
          this.showError('デモの初期化に失敗しました');
        }
      }
      
      render() {
        const container = document.getElementById('map-demo');
        
        // 仮の日本地図SVGを生成
        container.innerHTML = `
          <svg viewBox="0 0 800 600" style="background: ${this.getThemeColors().background}">
            <g id="prefectures">
              ${this.renderPrefectures()}
            </g>
            <g id="info-layer">
              <rect x="20" y="20" width="200" height="100" fill="rgba(255,255,255,0.9)" stroke="#ccc" rx="5"/>
              <text x="30" y="45" font-size="14" fill="#333">Japan Map Selector</text>
              <text x="30" y="65" font-size="12" fill="#666">インタラクティブデモ</text>
              <text x="30" y="85" font-size="12" fill="#666">テーマ: ${this.theme}</text>
              <text x="30" y="105" font-size="12" fill="#666">簡略化: ${this.simplificationLevel}</text>
            </g>
          </svg>
        `;
      }
      
      renderPrefectures() {
        // 仮の都道府県形状（実際にはGeoJSONデータから生成）
        const prefectures = [
          { id: '13', name: '東京都', x: 500, y: 350, size: 30 },
          { id: '27', name: '大阪府', x: 450, y: 380, size: 25 },
          { id: '14', name: '神奈川県', x: 510, y: 370, size: 20 },
          { id: '01', name: '北海道', x: 550, y: 150, size: 50 },
          { id: '47', name: '沖縄県', x: 150, y: 500, size: 20 }
        ];
        
        const colors = this.getThemeColors();
        
        return prefectures.map(pref => {
          const fill = this.getPrefectureColor(pref.id, colors);
          return `
            <g class="prefecture" data-id="${pref.id}" data-name="${pref.name}">
              <rect 
                x="${pref.x - pref.size}" 
                y="${pref.y - pref.size}" 
                width="${pref.size * 2}" 
                height="${pref.size * 2}"
                fill="${fill}" 
                stroke="${colors.stroke}" 
                stroke-width="1"
                style="cursor: pointer;"
              />
              <text 
                x="${pref.x}" 
                y="${pref.y}" 
                text-anchor="middle" 
                dominant-baseline="middle"
                font-size="12" 
                fill="${colors.text}"
                pointer-events="none"
              >${pref.name}</text>
            </g>
          `;
        }).join('');
      }
      
      getThemeColors() {
        const themes = {
          default: {
            background: '#f5f5f5',
            fill: '#4fc3f7',
            stroke: '#0288d1',
            hover: '#29b6f6',
            text: '#333'
          },
          dark: {
            background: '#1e1e1e',
            fill: '#424242',
            stroke: '#616161',
            hover: '#616161',
            text: '#fff'
          },
          colorful: {
            background: '#fff',
            fill: '#various',
            stroke: '#666',
            hover: '#various',
            text: '#333'
          }
        };
        
        return themes[this.theme] || themes.default;
      }
      
      getPrefectureColor(id, colors) {
        if (this.theme === 'colorful') {
          const colorMap = {
            '13': '#ff6b6b',
            '27': '#4ecdc4',
            '14': '#45b7d1',
            '01': '#96ceb4',
            '47': '#feca57'
          };
          return colorMap[id] || '#ddd';
        }
        return colors.fill;
      }
      
      setupEventListeners() {
        // テーマ変更
        document.getElementById('theme-select').addEventListener('change', (e) => {
          this.theme = e.target.value;
          this.render();
        });
        
        // 簡略化レベル変更
        document.getElementById('simplification-select').addEventListener('change', (e) => {
          this.simplificationLevel = e.target.value;
          this.render();
        });
        
        // ディフォルメモード変更
        document.getElementById('deform-select').addEventListener('change', (e) => {
          this.deformMode = e.target.value;
          this.render();
        });
        
        // リセットボタン
        document.getElementById('reset-btn').addEventListener('click', () => {
          this.selectedPrefecture = null;
          this.render();
          document.getElementById('demo-info').textContent = 
            '※これはデモ用の静的な表示です。実際の動作は本番環境でご確認ください。';
        });
        
        // 都道府県のインタラクション
        this.setupPrefectureInteractions();
      }
      
      setupPrefectureInteractions() {
        const svg = document.querySelector('#map-demo svg');
        if (!svg) return;
        
        svg.addEventListener('click', (e) => {
          const prefecture = e.target.closest('.prefecture');
          if (prefecture) {
            const name = prefecture.dataset.name;
            this.selectedPrefecture = name;
            document.getElementById('demo-info').textContent = 
              `${name}が選択されました（デモ）`;
          }
        });
        
        svg.addEventListener('mouseover', (e) => {
          const prefecture = e.target.closest('.prefecture');
          if (prefecture) {
            prefecture.querySelector('rect').style.opacity = '0.8';
          }
        });
        
        svg.addEventListener('mouseout', (e) => {
          const prefecture = e.target.closest('.prefecture');
          if (prefecture) {
            prefecture.querySelector('rect').style.opacity = '1';
          }
        });
      }
      
      showError(message) {
        document.getElementById('map-demo').innerHTML = 
          `<div class="error">${message}</div>`;
      }
    }
    
    // デモを開始
    new SimpleMapDemo();
  </script>
</body>
</html>